# ADR-003: Политики HTTP-клиента (таймауты, ретраи, лимиты)
Дата: 2025-10-20
Статус: Accepted

## Context
Исходящие HTTP-вызовы без ограничений по времени могут зависнуть и снизить SLA.
Нужно задать единые политики (таймауты, ретраи, лимиты).

## Decision
- В `app/core/config.py` добавлены поля:
  `HTTP_CONNECT_TIMEOUT = 2.0`, `HTTP_READ_TIMEOUT = 5.0`, `HTTP_TOTAL_TIMEOUT = 6.0`, `HTTP_MAX_RETRIES = 3`.
- Применяются только к идемпотентным методам (GET/HEAD).
- Экспоненциальные ретраи 1 → 2 → 4 с.
- Метрика: p95 времени ответа внешних вызовов ≤ 6 с.

## Consequences
**Плюсы:** предсказуемость и устойчивость, меньше зависаний.
**Минусы:** небольшое увеличение времени ответа при ретраях.

## Links
- NFR-03 (ошибки RFC 7807), NFR-10 (доступность)
- F3, R5 из Threat Model
- tests/test_http_client_policies.py::test_timeout_settings
